name: (Reusable Workflow) Publish packages
on:
    workflow_call:

jobs:
    publish_github:
        runs-on: ubuntu-24.04

        steps:
            - uses: actions/checkout@v4

            - uses: actions/setup-java@v4
              with:
                  java-version: '21'
                  distribution: 'temurin'

            - name: setup key
              run: |
                  chmod +x ./ci-utils/setup-gpg.sh
                  ./ci-utils/setup-gpg.sh
              env:
                  GPG_KEY: ${{ secrets.GPG_KEY }}
                  GPG_PASSWORD: ${{ secrets.GPG_PASSWORD }}

            - uses: gradle/actions/setup-gradle@v3

            # check out: https://docs.gradle.org/current/userguide/signing_plugin.html
            - name: Setup Gradle Signing
              run: gradle sign -Psigning.secretKeyRingFile=../../../.gnupg/secring.gpg -Psigning.password=${{ secrets.GPG_PASSWORD }} -Psigning.keyId=${{ secrets.GPG_KEYID }}
